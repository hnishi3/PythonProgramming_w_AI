
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>レッスン2：ディープラーニングの基礎 &#8212; Python Programming with AI</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://hnishi3.github.io/PythonProgramming_w_AI/2_ディープラーニングの基礎.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="レッスン1：機械学習の基礎" href="1_%E6%A9%9F%E6%A2%B0%E5%AD%A6%E7%BF%92%E3%81%AE%E5%9F%BA%E7%A4%8E.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo_s.jpeg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Python Programming with AI</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   はじめに
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Python プログラミング入門
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="1_Python%E3%81%AE%E5%9F%BA%E7%A4%8E.html">
   レッスン1：Pythonと基本的な構文の紹介
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2_%E5%A4%89%E6%95%B0%E3%80%81%E3%83%87%E3%83%BC%E3%82%BF%E5%9E%8B%E3%80%81%E6%BC%94%E7%AE%97%E5%AD%90.html">
   レッスン2：変数、データ型、演算子
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="3_%E6%9D%A1%E4%BB%B6%E5%88%86%E5%B2%90%E3%81%A8%E3%83%AB%E3%83%BC%E3%83%97.html">
   レッスン3：制御フロー - 条件分岐とループ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="4_%E3%83%87%E3%83%BC%E3%82%BF%E6%A7%8B%E9%80%A0.html">
   レッスン4：データ構造
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="5_%E9%96%A2%E6%95%B0%E3%81%AE%E5%9F%BA%E7%A4%8E%E3%81%A8%E3%83%A2%E3%82%B8%E3%83%A5%E3%83%BC%E3%83%AB.html">
   レッスン5：関数の基礎とモジュール
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="6_%E9%96%A2%E6%95%B0.html">
   レッスン6：関数
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="7_%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E5%85%A5%E5%87%BA%E5%8A%9B.html">
   レッスン7：ファイル入出力
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="8_Python%E3%81%AB%E3%82%88%E3%82%8B%E3%83%87%E3%83%BC%E3%82%BF%E3%82%B5%E3%82%A4%E3%82%A8%E3%83%B3%E3%82%B9%E5%85%A5%E9%96%80.html">
   レッスン8：Pythonによるデータサイエンス入門：NumPy, Pandas, Matplotlib
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="9_Python%E3%81%AB%E3%82%88%E3%82%8B%E6%A9%9F%E6%A2%B0%E5%AD%A6%E7%BF%92%E5%85%A5%E9%96%80.html">
   レッスン9：Pythonによる機械学習入門：Scikit-learn
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Python AI プログラミング入門
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="1_%E6%A9%9F%E6%A2%B0%E5%AD%A6%E7%BF%92%E3%81%AE%E5%9F%BA%E7%A4%8E.html">
   レッスン1：機械学習の基礎
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   レッスン2：ディープラーニングの基礎
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/2_ディープラーニングの基礎.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/hnishi3/PythonProgramming_w_AI"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   用語の説明
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id3">
   基本的なニューラルネットワーク（多層パーセプトロン）
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cnn">
   畳み込みニューラルネットワーク（CNN）
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#rnn">
   再帰型ニューラルネットワーク（RNN）
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>レッスン2：ディープラーニングの基礎</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   用語の説明
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id3">
   基本的なニューラルネットワーク（多層パーセプトロン）
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cnn">
   畳み込みニューラルネットワーク（CNN）
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#rnn">
   再帰型ニューラルネットワーク（RNN）
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="id1">
<h1>レッスン2：ディープラーニングの基礎<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<p>このセクションでは、ディープラーニングの基本的な概念とPythonでの実装について学びます。具体的には、以下のトピックをカバーします。</p>
<ul class="simple">
<li><p>ニューラルネットワーク</p></li>
<li><p>畳み込みニューラルネットワーク（CNN）</p></li>
<li><p>再帰型ニューラルネットワーク（RNN）</p></li>
</ul>
<div class="section" id="id2">
<h2>用語の説明<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><strong>ニューロン</strong>: ニューロンは、人間の脳の神経細胞を模倣した概念で、ニューラルネットワークの中心的な要素です。それぞれのニューロンは、複数の入力を受け取り、それらを一つの出力に変換します。この出力は、次の層のニューロンへの入力となります。</p></li>
<li><p><strong>入力層</strong>: 入力層は、ニューラルネットワークの最初の層で、データを受け取る部分です。例えば、画像を認識するネットワークでは、各ピクセルの色情報が入力層に供給されます。</p></li>
<li><p><strong>出力層</strong>: 出力層は、ニューラルネットワークの最後の層で、最終的な結果を出力します。例えば、手書き数字の認識では、出力層は0から9までの10個のニューロンから成り、最も高い値を出力するニューロンが認識結果となります。</p></li>
<li><p><strong>正規化</strong>: 正規化は、データを一定の範囲や形状に変換する処理です。例えば、色の強度を0から1の範囲に変換したり、平均が0で標準偏差が1になるようにデータをスケーリングしたりします。これにより、機械学習モデルの学習が容易になります。</p></li>
<li><p><strong>活性化関数</strong>: 活性化関数は、ニューロンの出力を決定する関数です。例えば、シグモイド関数は出力を0から1の間に制限し、ReLU関数は負の入力を0に、正の入力はそのままにします。これにより、ニューラルネットワークは非線形の問題も学習できます。</p></li>
<li><p><strong>損失関数</strong>: 損失関数は、モデルの予測がどれだけ正解から外れているかを測定する関数です。例えば、二乗誤差損失は、予測と正解の差を二乗したものを使います。損失が小さいほど、モデルの予測は正確です。</p></li>
<li><p><strong>最適化アルゴリズム</strong>: 最適化アルゴリズムは、損失関数を最小化するようにモデルのパラメータを更新する方法です。例えば、勾配降下法は、損失関数の勾配（傾き）が最も急な方向にパラメータを少しずつ移動させて、損失を減らします。これにより、モデルはデータから学習して改善します。</p></li>
</ul>
</div>
<div class="section" id="id3">
<h2>基本的なニューラルネットワーク（多層パーセプトロン）<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>ここでは、Pythonの深層学習ライブラリであるKerasを用いて、ニューラルネットワークの基本的な実装を示します。具体的には、手書き数字の画像を分類するニューラルネットワークを訓練します。</p>
<p>まず、必要なライブラリをインポートします。これらのライブラリは、ニューラルネットワークの構築と訓練に必要な機能を提供します。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 必要なライブラリのインポート</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.datasets</span> <span class="kn">import</span> <span class="n">mnist</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.models</span> <span class="kn">import</span> <span class="n">Sequential</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">Dense</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.utils</span> <span class="kn">import</span> <span class="n">to_categorical</span>

<span class="c1"># 乱数の種を固定</span>
<span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">set_seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>次に、MNISTという手書き数字のデータセットをロードします。このデータセットは、0から9までの手書き数字の画像（28x28ピクセル）と、それぞれの画像が何の数字であるかを示すラベルから構成されています。データセットは訓練データとテストデータの2つに分けられ、訓練データでモデルを訓練した後、テストデータでモデルの性能を評価します。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># データセットのロード</span>
<span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">),</span> <span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span> <span class="o">=</span> <span class="n">mnist</span><span class="o">.</span><span class="n">load_data</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/mnist.npz
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   16384/11490434 [..............................] - ETA: 42s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
   49152/11490434 [..............................] - ETA: 37s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
   81920/11490434 [..............................] - ETA: 36s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
  147456/11490434 [..............................] - ETA: 24s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
  212992/11490434 [..............................] - ETA: 20s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
  294912/11490434 [..............................] - ETA: 16s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
  458752/11490434 [&gt;.............................] - ETA: 11s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
  622592/11490434 [&gt;.............................] - ETA: 9s 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
  811008/11490434 [=&gt;............................] - ETA: 7s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 1376256/11490434 [==&gt;...........................] - ETA: 4s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 2080768/11490434 [====&gt;.........................] - ETA: 3s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 3088384/11490434 [=======&gt;......................] - ETA: 2s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 3907584/11490434 [=========&gt;....................] - ETA: 1s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 5095424/11490434 [============&gt;.................] - ETA: 1s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 5963776/11490434 [==============&gt;...............] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 6963200/11490434 [=================&gt;............] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 7782400/11490434 [===================&gt;..........] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 8830976/11490434 [======================&gt;.......] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 9568256/11490434 [=======================&gt;......] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
10633216/11490434 [==========================&gt;...] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11337728/11490434 [============================&gt;.] - ETA: 0s
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11493376/11490434 [==============================] - 1s 0us/step
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
11501568/11490434 [==============================] - 1s 0us/step
</pre></div>
</div>
</div>
</div>
<p>データの前処理を行います。画像データは、各ピクセルが0から255の値を持つ2次元配列として表現されます。これを1次元配列に変換し、値を0から1の範囲に正規化します。また、ラベルデータは、各画像がどの数字であるかを示す整数ですが、これをカテゴリ形式（多クラス分類）に変換します。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># データの前処理</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">28</span> <span class="o">*</span> <span class="mi">28</span><span class="p">))</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="mi">255</span>

<span class="n">X_test</span> <span class="o">=</span> <span class="n">X_test</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">28</span> <span class="o">*</span> <span class="mi">28</span><span class="p">))</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">X_test</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="mi">255</span>

<span class="n">y_train</span> <span class="o">=</span> <span class="n">to_categorical</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">to_categorical</span><span class="p">(</span><span class="n">y_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>次に、ニューラルネットワークのモデルを作成します。ここでは、全結合層（Dense）のみからなるシンプルなニューラルネットワークを作成します。全結合層とは、前の層の全てのニューロンが次の層の全てのニューロンと接続されている層のことを指します。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># モデルの作成</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Sequential</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">28</span> <span class="o">*</span> <span class="mi">28</span><span class="p">,)))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;softmax&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>このモデルは、入力層、隠れ層、出力層の3つの層から構成されています。入力層のニューロンの数は、入力データの次元数（ここでは28*28=784）と同じです。隠れ層は512のニューロンを持ち、活性化関数としてReLU（Rectified Linear Unit）を使用します。出力層は10のニューロンを持ち、活性化関数としてソフトマックスを使用します。ソフトマックス関数は、各出力ニューロンの出力を0から1の間の確率に変換します。</p>
<p><img alt="image.png" src="_images/nn.png" /></p>
<p>また、ReLU関数は以下のような形状になっています。</p>
<p>参考：ReLU関数　<a class="reference external" href="https://www.wolframalpha.com/input?i=ReLU+function">https://www.wolframalpha.com/input?i=ReLU+function</a></p>
<p><img alt="image.png" src="_images/relu.png" /></p>
<p>次に、モデルをコンパイルします。これは、モデルの学習方法を設定するステップです。損失関数、最適化アルゴリズム、評価指標を指定します。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># モデルのコンパイル</span>
<span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s1">&#39;categorical_crossentropy&#39;</span><span class="p">,</span>
              <span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;rmsprop&#39;</span><span class="p">,</span>
              <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>最後に、モデルを訓練します。訓練データを用いてモデルのパラメータを更新し、最適なパラメータを見つけ出します。エポック数は訓練データを何回繰り返して学習するかを指定します。バッチサイズは一度に学習するデータの数を指定します。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># モデルの訓練</span>
<span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span>
                    <span class="n">epochs</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                    <span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span>
                    <span class="n">validation_data</span><span class="o">=</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 1/5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  1/469 [..............................] - ETA: 3:13 - loss: 2.4631 - accuracy: 0.1016
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
  6/469 [..............................] - ETA: 4s - loss: 1.5708 - accuracy: 0.5013  
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 15/469 [..............................] - ETA: 3s - loss: 1.0866 - accuracy: 0.6771
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 29/469 [&gt;.............................] - ETA: 2s - loss: 0.8118 - accuracy: 0.7651
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 47/469 [==&gt;...........................] - ETA: 1s - loss: 0.6677 - accuracy: 0.8067
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 66/469 [===&gt;..........................] - ETA: 1s - loss: 0.5811 - accuracy: 0.8325
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 82/469 [====&gt;.........................] - ETA: 1s - loss: 0.5370 - accuracy: 0.8446
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 97/469 [=====&gt;........................] - ETA: 1s - loss: 0.5030 - accuracy: 0.8545
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
113/469 [======&gt;.......................] - ETA: 1s - loss: 0.4688 - accuracy: 0.8640
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
131/469 [=======&gt;......................] - ETA: 1s - loss: 0.4384 - accuracy: 0.8718
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
148/469 [========&gt;.....................] - ETA: 1s - loss: 0.4175 - accuracy: 0.8789
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
163/469 [=========&gt;....................] - ETA: 1s - loss: 0.4009 - accuracy: 0.8837
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
179/469 [==========&gt;...................] - ETA: 1s - loss: 0.3852 - accuracy: 0.8883
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
196/469 [===========&gt;..................] - ETA: 0s - loss: 0.3714 - accuracy: 0.8923
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
214/469 [============&gt;.................] - ETA: 0s - loss: 0.3575 - accuracy: 0.8962
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
230/469 [=============&gt;................] - ETA: 0s - loss: 0.3495 - accuracy: 0.8984
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
248/469 [==============&gt;...............] - ETA: 0s - loss: 0.3397 - accuracy: 0.9014
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
266/469 [================&gt;.............] - ETA: 0s - loss: 0.3292 - accuracy: 0.9044
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
285/469 [=================&gt;............] - ETA: 0s - loss: 0.3200 - accuracy: 0.9069
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
304/469 [==================&gt;...........] - ETA: 0s - loss: 0.3112 - accuracy: 0.9095
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
323/469 [===================&gt;..........] - ETA: 0s - loss: 0.3034 - accuracy: 0.9120
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
342/469 [====================&gt;.........] - ETA: 0s - loss: 0.2961 - accuracy: 0.9145
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
360/469 [======================&gt;.......] - ETA: 0s - loss: 0.2894 - accuracy: 0.9163
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
378/469 [=======================&gt;......] - ETA: 0s - loss: 0.2826 - accuracy: 0.9184
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
394/469 [========================&gt;.....] - ETA: 0s - loss: 0.2791 - accuracy: 0.9194
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
411/469 [=========================&gt;....] - ETA: 0s - loss: 0.2744 - accuracy: 0.9206
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
428/469 [==========================&gt;...] - ETA: 0s - loss: 0.2681 - accuracy: 0.9222
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
442/469 [===========================&gt;..] - ETA: 0s - loss: 0.2642 - accuracy: 0.9233
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
458/469 [============================&gt;.] - ETA: 0s - loss: 0.2604 - accuracy: 0.9245
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
469/469 [==============================] - 2s 4ms/step - loss: 0.2573 - accuracy: 0.9253 - val_loss: 0.1260 - val_accuracy: 0.9623
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 2/5

  1/469 [..............................] - ETA: 1s - loss: 0.1235 - accuracy: 0.9609
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 16/469 [&gt;.............................] - ETA: 1s - loss: 0.0897 - accuracy: 0.9707
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 32/469 [=&gt;............................] - ETA: 1s - loss: 0.0931 - accuracy: 0.9707
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 50/469 [==&gt;...........................] - ETA: 1s - loss: 0.1018 - accuracy: 0.9683
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 68/469 [===&gt;..........................] - ETA: 1s - loss: 0.1069 - accuracy: 0.9661
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 86/469 [====&gt;.........................] - ETA: 1s - loss: 0.1139 - accuracy: 0.9648
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
104/469 [=====&gt;........................] - ETA: 1s - loss: 0.1126 - accuracy: 0.9656
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
123/469 [======&gt;.......................] - ETA: 1s - loss: 0.1129 - accuracy: 0.9665
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
142/469 [========&gt;.....................] - ETA: 0s - loss: 0.1140 - accuracy: 0.9658
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
160/469 [=========&gt;....................] - ETA: 0s - loss: 0.1119 - accuracy: 0.9666
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
179/469 [==========&gt;...................] - ETA: 0s - loss: 0.1128 - accuracy: 0.9660
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
198/469 [===========&gt;..................] - ETA: 0s - loss: 0.1129 - accuracy: 0.9659
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
216/469 [============&gt;.................] - ETA: 0s - loss: 0.1105 - accuracy: 0.9666
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
233/469 [=============&gt;................] - ETA: 0s - loss: 0.1114 - accuracy: 0.9663
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
251/469 [===============&gt;..............] - ETA: 0s - loss: 0.1094 - accuracy: 0.9669
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
269/469 [================&gt;.............] - ETA: 0s - loss: 0.1099 - accuracy: 0.9671
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
287/469 [=================&gt;............] - ETA: 0s - loss: 0.1094 - accuracy: 0.9673
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
303/469 [==================&gt;...........] - ETA: 0s - loss: 0.1087 - accuracy: 0.9674
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
320/469 [===================&gt;..........] - ETA: 0s - loss: 0.1074 - accuracy: 0.9678
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
337/469 [====================&gt;.........] - ETA: 0s - loss: 0.1068 - accuracy: 0.9682
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
355/469 [=====================&gt;........] - ETA: 0s - loss: 0.1063 - accuracy: 0.9684
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
372/469 [======================&gt;.......] - ETA: 0s - loss: 0.1058 - accuracy: 0.9686
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
391/469 [========================&gt;.....] - ETA: 0s - loss: 0.1051 - accuracy: 0.9689
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
409/469 [=========================&gt;....] - ETA: 0s - loss: 0.1042 - accuracy: 0.9692
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
427/469 [==========================&gt;...] - ETA: 0s - loss: 0.1048 - accuracy: 0.9690
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
446/469 [===========================&gt;..] - ETA: 0s - loss: 0.1050 - accuracy: 0.9689
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
464/469 [============================&gt;.] - ETA: 0s - loss: 0.1045 - accuracy: 0.9691
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
469/469 [==============================] - 1s 3ms/step - loss: 0.1043 - accuracy: 0.9691 - val_loss: 0.1072 - val_accuracy: 0.9657
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 3/5

  1/469 [..............................] - ETA: 1s - loss: 0.0571 - accuracy: 0.9844
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 17/469 [&gt;.............................] - ETA: 1s - loss: 0.0761 - accuracy: 0.9784
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 33/469 [=&gt;............................] - ETA: 1s - loss: 0.0760 - accuracy: 0.9777
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 51/469 [==&gt;...........................] - ETA: 1s - loss: 0.0796 - accuracy: 0.9755
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 68/469 [===&gt;..........................] - ETA: 1s - loss: 0.0773 - accuracy: 0.9769
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 86/469 [====&gt;.........................] - ETA: 1s - loss: 0.0768 - accuracy: 0.9777
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
104/469 [=====&gt;........................] - ETA: 1s - loss: 0.0760 - accuracy: 0.9778
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
123/469 [======&gt;.......................] - ETA: 1s - loss: 0.0744 - accuracy: 0.9782
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
141/469 [========&gt;.....................] - ETA: 0s - loss: 0.0729 - accuracy: 0.9782
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
160/469 [=========&gt;....................] - ETA: 0s - loss: 0.0732 - accuracy: 0.9783
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
179/469 [==========&gt;...................] - ETA: 0s - loss: 0.0732 - accuracy: 0.9785
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
197/469 [===========&gt;..................] - ETA: 0s - loss: 0.0718 - accuracy: 0.9787
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
216/469 [============&gt;.................] - ETA: 0s - loss: 0.0719 - accuracy: 0.9786
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
233/469 [=============&gt;................] - ETA: 0s - loss: 0.0714 - accuracy: 0.9786
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
251/469 [===============&gt;..............] - ETA: 0s - loss: 0.0710 - accuracy: 0.9787
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
269/469 [================&gt;.............] - ETA: 0s - loss: 0.0709 - accuracy: 0.9789
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
287/469 [=================&gt;............] - ETA: 0s - loss: 0.0715 - accuracy: 0.9788
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
305/469 [==================&gt;...........] - ETA: 0s - loss: 0.0714 - accuracy: 0.9788
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
323/469 [===================&gt;..........] - ETA: 0s - loss: 0.0708 - accuracy: 0.9790
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
341/469 [====================&gt;.........] - ETA: 0s - loss: 0.0702 - accuracy: 0.9791
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
358/469 [=====================&gt;........] - ETA: 0s - loss: 0.0700 - accuracy: 0.9791
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
376/469 [=======================&gt;......] - ETA: 0s - loss: 0.0698 - accuracy: 0.9792
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
395/469 [========================&gt;.....] - ETA: 0s - loss: 0.0694 - accuracy: 0.9793
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
413/469 [=========================&gt;....] - ETA: 0s - loss: 0.0697 - accuracy: 0.9792
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
431/469 [==========================&gt;...] - ETA: 0s - loss: 0.0693 - accuracy: 0.9792
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
450/469 [===========================&gt;..] - ETA: 0s - loss: 0.0688 - accuracy: 0.9795
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
468/469 [============================&gt;.] - ETA: 0s - loss: 0.0686 - accuracy: 0.9795
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
469/469 [==============================] - 1s 3ms/step - loss: 0.0687 - accuracy: 0.9794 - val_loss: 0.0822 - val_accuracy: 0.9746
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 4/5

  1/469 [..............................] - ETA: 1s - loss: 0.0564 - accuracy: 0.9844
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 19/469 [&gt;.............................] - ETA: 1s - loss: 0.0474 - accuracy: 0.9881
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 37/469 [=&gt;............................] - ETA: 1s - loss: 0.0471 - accuracy: 0.9871
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 55/469 [==&gt;...........................] - ETA: 1s - loss: 0.0481 - accuracy: 0.9864
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 73/469 [===&gt;..........................] - ETA: 1s - loss: 0.0485 - accuracy: 0.9861
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 91/469 [====&gt;.........................] - ETA: 1s - loss: 0.0491 - accuracy: 0.9857
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
109/469 [=====&gt;........................] - ETA: 1s - loss: 0.0489 - accuracy: 0.9855
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
127/469 [=======&gt;......................] - ETA: 0s - loss: 0.0488 - accuracy: 0.9855
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
145/469 [========&gt;.....................] - ETA: 0s - loss: 0.0496 - accuracy: 0.9852
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
159/469 [=========&gt;....................] - ETA: 0s - loss: 0.0500 - accuracy: 0.9847
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
177/469 [==========&gt;...................] - ETA: 0s - loss: 0.0517 - accuracy: 0.9843
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
195/469 [===========&gt;..................] - ETA: 0s - loss: 0.0525 - accuracy: 0.9840
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
212/469 [============&gt;.................] - ETA: 0s - loss: 0.0526 - accuracy: 0.9837
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
229/469 [=============&gt;................] - ETA: 0s - loss: 0.0523 - accuracy: 0.9838
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
245/469 [==============&gt;...............] - ETA: 0s - loss: 0.0523 - accuracy: 0.9837
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
260/469 [===============&gt;..............] - ETA: 0s - loss: 0.0523 - accuracy: 0.9839
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
278/469 [================&gt;.............] - ETA: 0s - loss: 0.0513 - accuracy: 0.9842
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
296/469 [=================&gt;............] - ETA: 0s - loss: 0.0511 - accuracy: 0.9842
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
314/469 [===================&gt;..........] - ETA: 0s - loss: 0.0511 - accuracy: 0.9843
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
332/469 [====================&gt;.........] - ETA: 0s - loss: 0.0507 - accuracy: 0.9842
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
350/469 [=====================&gt;........] - ETA: 0s - loss: 0.0512 - accuracy: 0.9841
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
368/469 [======================&gt;.......] - ETA: 0s - loss: 0.0515 - accuracy: 0.9841
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
386/469 [=======================&gt;......] - ETA: 0s - loss: 0.0509 - accuracy: 0.9843
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
404/469 [========================&gt;.....] - ETA: 0s - loss: 0.0506 - accuracy: 0.9845
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
422/469 [=========================&gt;....] - ETA: 0s - loss: 0.0503 - accuracy: 0.9845
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
440/469 [===========================&gt;..] - ETA: 0s - loss: 0.0499 - accuracy: 0.9847
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
458/469 [============================&gt;.] - ETA: 0s - loss: 0.0505 - accuracy: 0.9846
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
469/469 [==============================] - 1s 3ms/step - loss: 0.0505 - accuracy: 0.9845 - val_loss: 0.0718 - val_accuracy: 0.9790
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 5/5

  1/469 [..............................] - ETA: 1s - loss: 0.0134 - accuracy: 1.0000
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 19/469 [&gt;.............................] - ETA: 1s - loss: 0.0244 - accuracy: 0.9926
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 37/469 [=&gt;............................] - ETA: 1s - loss: 0.0300 - accuracy: 0.9911
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 52/469 [==&gt;...........................] - ETA: 1s - loss: 0.0303 - accuracy: 0.9911
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 70/469 [===&gt;..........................] - ETA: 1s - loss: 0.0304 - accuracy: 0.9911
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
 87/469 [====&gt;.........................] - ETA: 1s - loss: 0.0307 - accuracy: 0.9911
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
104/469 [=====&gt;........................] - ETA: 1s - loss: 0.0316 - accuracy: 0.9907
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
122/469 [======&gt;.......................] - ETA: 1s - loss: 0.0329 - accuracy: 0.9905
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
141/469 [========&gt;.....................] - ETA: 0s - loss: 0.0333 - accuracy: 0.9900
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
160/469 [=========&gt;....................] - ETA: 0s - loss: 0.0323 - accuracy: 0.9902
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
178/469 [==========&gt;...................] - ETA: 0s - loss: 0.0327 - accuracy: 0.9901
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
196/469 [===========&gt;..................] - ETA: 0s - loss: 0.0342 - accuracy: 0.9896
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
215/469 [============&gt;.................] - ETA: 0s - loss: 0.0337 - accuracy: 0.9897
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
231/469 [=============&gt;................] - ETA: 0s - loss: 0.0334 - accuracy: 0.9898
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
248/469 [==============&gt;...............] - ETA: 0s - loss: 0.0341 - accuracy: 0.9897
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
267/469 [================&gt;.............] - ETA: 0s - loss: 0.0348 - accuracy: 0.9895
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
286/469 [=================&gt;............] - ETA: 0s - loss: 0.0352 - accuracy: 0.9893
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
305/469 [==================&gt;...........] - ETA: 0s - loss: 0.0352 - accuracy: 0.9894
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
323/469 [===================&gt;..........] - ETA: 0s - loss: 0.0356 - accuracy: 0.9892
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
342/469 [====================&gt;.........] - ETA: 0s - loss: 0.0358 - accuracy: 0.9892
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
361/469 [======================&gt;.......] - ETA: 0s - loss: 0.0360 - accuracy: 0.9892
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
380/469 [=======================&gt;......] - ETA: 0s - loss: 0.0367 - accuracy: 0.9889
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
399/469 [========================&gt;.....] - ETA: 0s - loss: 0.0374 - accuracy: 0.9887
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
416/469 [=========================&gt;....] - ETA: 0s - loss: 0.0375 - accuracy: 0.9886
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
434/469 [==========================&gt;...] - ETA: 0s - loss: 0.0376 - accuracy: 0.9886
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
450/469 [===========================&gt;..] - ETA: 0s - loss: 0.0376 - accuracy: 0.9885
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
468/469 [============================&gt;.] - ETA: 0s - loss: 0.0379 - accuracy: 0.9885
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
469/469 [==============================] - 1s 3ms/step - loss: 0.0378 - accuracy: 0.9885 - val_loss: 0.0677 - val_accuracy: 0.9793
</pre></div>
</div>
</div>
</div>
<p>以下のコードは、訓練データと検証データ（ここではテストデータ）の精度と損失をそれぞれプロットします。これにより、モデルが訓練データにどれだけ適合しているか、また、未見のデータに対するモデルの性能を視覚的に理解することができます。</p>
<p>なお、’bo’は青色の丸を、’b’は青色の線を意味します。また、’Training acc’や’Validation acc’などは、グラフの凡例に表示されるラベルです。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># 訓練の精度と損失値を取得</span>
<span class="n">acc</span> <span class="o">=</span> <span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">]</span>
<span class="n">val_acc</span> <span class="o">=</span> <span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;val_accuracy&#39;</span><span class="p">]</span>
<span class="n">loss</span> <span class="o">=</span> <span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;loss&#39;</span><span class="p">]</span>
<span class="n">val_loss</span> <span class="o">=</span> <span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;val_loss&#39;</span><span class="p">]</span>

<span class="n">epochs</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">acc</span><span class="p">))</span>

<span class="c1"># 訓練データと検証データの精度をプロット</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">epochs</span><span class="p">,</span> <span class="n">acc</span><span class="p">,</span> <span class="s1">&#39;bo&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Training acc&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">epochs</span><span class="p">,</span> <span class="n">val_acc</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Validation acc&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Training and validation accuracy&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>

<span class="c1"># 訓練データと検証データの損失値をプロット</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">epochs</span><span class="p">,</span> <span class="n">loss</span><span class="p">,</span> <span class="s1">&#39;bo&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Training loss&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">epochs</span><span class="p">,</span> <span class="n">val_loss</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Validation loss&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Training and validation loss&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">7</span><span class="o">-</span><span class="mi">9</span><span class="n">b46599f798f</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> 
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="c1"># 訓練の精度と損失値を取得</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">acc</span> <span class="o">=</span> <span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">]</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">val_acc</span> <span class="o">=</span> <span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;val_accuracy&#39;</span><span class="p">]</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;matplotlib&#39;
</pre></div>
</div>
</div>
</div>
<p>以上が、ニューラルネットワークを用いた手書き数字の分類の基本的な流れです。一連のコードによって、手書き数字の画像を認識するニューラルネットワークのモデルを訓練し、新しい手書き文字に対してその数字がなんであるかを分類することができます。</p>
</div>
<div class="section" id="cnn">
<h2>畳み込みニューラルネットワーク（CNN）<a class="headerlink" href="#cnn" title="Permalink to this headline">¶</a></h2>
<p>畳み込みニューラルネットワーク（CNN）とは、画像や音声を認識するための特殊な種類の人工知能です。これは、画像の一部分の特徴を見つける「畳み込み層」、特徴の情報を簡単にする「プーリング層」、そして最終的にどのカテゴリに分類するかを決める「全結合層」の三つの部分から成り立っています。</p>
<p>以下に、PythonとKeras（人工知能を作るためのツール）を使って、CNNを作る基本的な手順を説明します。</p>
<p>まず、必要なツールを読み込みます。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 必要なライブラリのインポート</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.datasets</span> <span class="kn">import</span> <span class="n">cifar10</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.models</span> <span class="kn">import</span> <span class="n">Sequential</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">Flatten</span><span class="p">,</span> <span class="n">Conv2D</span><span class="p">,</span> <span class="n">MaxPooling2D</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.utils</span> <span class="kn">import</span> <span class="n">to_categorical</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># 乱数の種を固定</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">set_seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>次に、学習に使うデータを読み込みます。今回はCIFAR-10を使います。CIFAR-10は、10種類のラベル（自動車、鳥、猫など）が付けられた32x32ピクセルのカラー画像60000枚から成るデータセットです。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># データセットのロード</span>
<span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">),</span> <span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span> <span class="o">=</span> <span class="n">cifar10</span><span class="o">.</span><span class="n">load_data</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>その後、データを適切な形に整形します。画像データは0から255の範囲の整数で表されますが、これを0から1の範囲に変換します。
また、ラベルデータ（y_trainとy_test）をカテゴリカル表現に変換します。これは、各ラベルを10次元のベクトルで表現する方法で、モデルの出力と一致させるために必要です。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># データの前処理</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="mi">255</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">X_test</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="mi">255</span>

<span class="n">y_train</span> <span class="o">=</span> <span class="n">to_categorical</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">to_categorical</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>そして、CNNのモデルを作ります。これは、畳み込み層(Conv2D)、プーリング層(MaxPooling2D)、全結合層(Dense)を順番に追加していきます。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># モデルの作成開始</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>

<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Conv2D</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">3</span><span class="p">)))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">MaxPooling2D</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Conv2D</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">MaxPooling2D</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Conv2D</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Flatten</span><span class="p">())</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;softmax&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>モデルを作ったら、それをどのように学習させるかを設定します。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># モデルのコンパイル</span>
<span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s1">&#39;categorical_crossentropy&#39;</span><span class="p">,</span>
              <span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;rmsprop&#39;</span><span class="p">,</span>
              <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>最後に、モデルを実際に学習させます。
今回は少し時間がかかるので、このウィンドウは開いたままにしておいてください。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># モデルの訓練</span>
<span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span>
                    <span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                    <span class="n">batch_size</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span>
                    <span class="n">validation_data</span><span class="o">=</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 1/10
782/782 [==============================] - 81s 103ms/step - loss: 1.6790 - accuracy: 0.3951 - val_loss: 1.6580 - val_accuracy: 0.4282
Epoch 2/10
782/782 [==============================] - 77s 99ms/step - loss: 1.2715 - accuracy: 0.5502 - val_loss: 1.2968 - val_accuracy: 0.5437
Epoch 3/10
782/782 [==============================] - 75s 96ms/step - loss: 1.0806 - accuracy: 0.6216 - val_loss: 1.1639 - val_accuracy: 0.6026
Epoch 4/10
782/782 [==============================] - 79s 101ms/step - loss: 0.9567 - accuracy: 0.6668 - val_loss: 1.0006 - val_accuracy: 0.6499
Epoch 5/10
782/782 [==============================] - 77s 98ms/step - loss: 0.8634 - accuracy: 0.6999 - val_loss: 1.0632 - val_accuracy: 0.6449
Epoch 6/10
782/782 [==============================] - 79s 101ms/step - loss: 0.7899 - accuracy: 0.7246 - val_loss: 1.0297 - val_accuracy: 0.6461
Epoch 7/10
782/782 [==============================] - 77s 98ms/step - loss: 0.7276 - accuracy: 0.7464 - val_loss: 0.9319 - val_accuracy: 0.6842
Epoch 8/10
782/782 [==============================] - 77s 98ms/step - loss: 0.6738 - accuracy: 0.7653 - val_loss: 1.0721 - val_accuracy: 0.6444
Epoch 9/10
782/782 [==============================] - 77s 98ms/step - loss: 0.6217 - accuracy: 0.7839 - val_loss: 0.9912 - val_accuracy: 0.6725
Epoch 10/10
782/782 [==============================] - 78s 99ms/step - loss: 0.5731 - accuracy: 0.8005 - val_loss: 0.9337 - val_accuracy: 0.6961
</pre></div>
</div>
</div>
</div>
<p>訓練済みのモデルの出力を確認してみましょう。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 予測</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># # 予測結果を表示するための準備。CIFAR-10の各クラスに対応する名前をリストとして作成。</span>
<span class="n">class_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;airplane&#39;</span><span class="p">,</span> <span class="s1">&#39;automobile&#39;</span><span class="p">,</span> <span class="s1">&#39;bird&#39;</span><span class="p">,</span> <span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="s1">&#39;deer&#39;</span><span class="p">,</span> <span class="s1">&#39;dog&#39;</span><span class="p">,</span> <span class="s1">&#39;frog&#39;</span><span class="p">,</span> <span class="s1">&#39;horse&#39;</span><span class="p">,</span> <span class="s1">&#39;ship&#39;</span><span class="p">,</span> <span class="s1">&#39;truck&#39;</span><span class="p">]</span>

<span class="c1"># 最初の25枚の画像と予測結果を表示</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">25</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">X_test</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">binary</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">class_names</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">predictions</span><span class="p">[</span><span class="n">i</span><span class="p">])])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>313/313 [==============================] - 4s 14ms/step
</pre></div>
</div>
<img alt="_images/2_ディープラーニングの基礎_34_1.png" src="_images/2_ディープラーニングの基礎_34_1.png" />
</div>
</div>
<p>以上が、CNNを作る基本的な手順です。</p>
</div>
<div class="section" id="rnn">
<h2>再帰型ニューラルネットワーク（RNN）<a class="headerlink" href="#rnn" title="Permalink to this headline">¶</a></h2>
<p>再帰型ニューラルネットワーク（RNN）は、時間の流れに沿ったデータ（例えば、文章や音声などのシーケンスデータ）を処理するのに適した人工知能の一種です。RNNは特別な「隠れ層」を持っており、これが過去の情報を覚えておく役割を果たします。そのため、時刻が進むごとにこの隠れ層の情報が更新され、新しい出力を生み出します。</p>
<p>以下に、PythonとKerasを使ったRNNの作り方を示します。以下のコードは映画のレビューが肯定的か否定的かを判定する人工知能を作ります。人工知能はレビューの文章を読んで、その内容が肯定的か否定的かを学習し、新しいレビューに対する予測を行います。</p>
<p>まずはデータの準備から始めます。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 必要なライブラリのインポート</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">SimpleRNN</span><span class="p">,</span> <span class="n">Embedding</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.datasets</span> <span class="kn">import</span> <span class="n">imdb</span>

<span class="c1"># 映画のレビューデータセットの読み込み</span>
<span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">),</span> <span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span> <span class="o">=</span> <span class="n">imdb</span><span class="o">.</span><span class="n">load_data</span><span class="p">(</span><span class="n">num_words</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>

<span class="c1"># データが長さの異なる文章からなるため、全ての文章が同じ長さになるように補正</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">preprocessing</span><span class="o">.</span><span class="n">sequence</span><span class="o">.</span><span class="n">pad_sequences</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">maxlen</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">preprocessing</span><span class="o">.</span><span class="n">sequence</span><span class="o">.</span><span class="n">pad_sequences</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">maxlen</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/imdb.npz
17464789/17464789 [==============================] - 0s 0us/step
</pre></div>
</div>
</div>
</div>
<p>次に、ニューラルネットワークのモデルを作ります。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># モデルの作成開始</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>
<span class="c1"># Embedding層は単語をベクトル（数値の並び）に変換する</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Embedding</span><span class="p">(</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">32</span><span class="p">))</span>
<span class="c1"># SimpleRNN層がRNNの中心的な部分</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">SimpleRNN</span><span class="p">(</span><span class="mi">32</span><span class="p">))</span>
<span class="c1"># Dense層は最終的な出力を生成する</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;sigmoid&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>そして、このモデルをどのように学習させるかを設定し、実際にモデルを学習させます。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># モデルの学習方法を決める</span>
<span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;rmsprop&#39;</span><span class="p">,</span>
              <span class="n">loss</span><span class="o">=</span><span class="s1">&#39;binary_crossentropy&#39;</span><span class="p">,</span>
              <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;acc&#39;</span><span class="p">])</span>

<span class="c1"># モデルの訓練</span>
<span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span>
                    <span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                    <span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span>
                    <span class="n">validation_split</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch 1/10
157/157 [==============================] - 31s 192ms/step - loss: 0.6713 - acc: 0.5814 - val_loss: 0.6302 - val_acc: 0.6338
Epoch 2/10
157/157 [==============================] - 30s 190ms/step - loss: 0.4620 - acc: 0.7892 - val_loss: 0.3804 - val_acc: 0.8418
Epoch 3/10
157/157 [==============================] - 30s 192ms/step - loss: 0.3347 - acc: 0.8638 - val_loss: 0.5417 - val_acc: 0.7556
Epoch 4/10
157/157 [==============================] - 28s 181ms/step - loss: 0.2522 - acc: 0.9003 - val_loss: 0.3802 - val_acc: 0.8430
Epoch 5/10
157/157 [==============================] - 28s 182ms/step - loss: 0.1913 - acc: 0.9301 - val_loss: 0.5282 - val_acc: 0.7550
Epoch 6/10
157/157 [==============================] - 29s 182ms/step - loss: 0.1317 - acc: 0.9548 - val_loss: 0.4642 - val_acc: 0.8084
Epoch 7/10
157/157 [==============================] - 30s 191ms/step - loss: 0.0880 - acc: 0.9712 - val_loss: 0.5166 - val_acc: 0.8428
Epoch 8/10
157/157 [==============================] - 29s 183ms/step - loss: 0.0691 - acc: 0.9782 - val_loss: 0.5721 - val_acc: 0.7882
Epoch 9/10
157/157 [==============================] - 28s 182ms/step - loss: 0.0437 - acc: 0.9867 - val_loss: 0.5681 - val_acc: 0.8450
Epoch 10/10
157/157 [==============================] - 28s 181ms/step - loss: 0.0314 - acc: 0.9919 - val_loss: 0.6087 - val_acc: 0.8320
</pre></div>
</div>
</div>
</div>
<p>historyという変数には学習過程の情報が保存されています。これをプロットすることで学習の経過を視覚的に確認することができます。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># 精度と損失の履歴を取得します</span>
<span class="n">acc</span> <span class="o">=</span> <span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;acc&#39;</span><span class="p">]</span>
<span class="n">val_acc</span> <span class="o">=</span> <span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;val_acc&#39;</span><span class="p">]</span>
<span class="n">loss</span> <span class="o">=</span> <span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;loss&#39;</span><span class="p">]</span>
<span class="n">val_loss</span> <span class="o">=</span> <span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;val_loss&#39;</span><span class="p">]</span>

<span class="n">epochs</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">acc</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># 精度のプロット</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">epochs</span><span class="p">,</span> <span class="n">acc</span><span class="p">,</span> <span class="s1">&#39;bo&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Training acc&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">epochs</span><span class="p">,</span> <span class="n">val_acc</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Validation acc&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Training and validation accuracy&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># 損失のプロット</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">epochs</span><span class="p">,</span> <span class="n">loss</span><span class="p">,</span> <span class="s1">&#39;bo&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Training loss&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">epochs</span><span class="p">,</span> <span class="n">val_loss</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Validation loss&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Training and validation loss&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2_ディープラーニングの基礎_43_0.png" src="_images/2_ディープラーニングの基礎_43_0.png" />
</div>
</div>
<p>以下のコードはテストデータセットの最初の10個のレビューに対する予測を表示します。予測値（prediction）は0から1の間の値で、値が0.5以上ならば肯定的なレビュー（’Positive’）、0.5未満ならば否定的なレビュー（’Negative’）と判断しています。
また、imdb.load_data()関数でロードしたデータは既に単語を数値に変換した形で提供されているため、実際のレビューのテキストとともに結果を表示するために、数値を再び単語に戻す処理が追加されています。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># IMDBデータセットの単語とインデックスの対応関係を取得</span>
<span class="n">word_index</span> <span class="o">=</span> <span class="n">imdb</span><span class="o">.</span><span class="n">get_word_index</span><span class="p">()</span>

<span class="c1"># インデックスと単語の対応関係（逆引き）を作成</span>
<span class="n">reverse_word_index</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">value</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="ow">in</span> <span class="n">word_index</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>

<span class="c1"># テストデータから10個のサンプルを取り出し、予測と共に表示</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">X_test</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">prediction</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">predictions</span><span class="p">)):</span>
    <span class="c1"># 数値を単語に戻す</span>
    <span class="n">decoded_review</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">reverse_word_index</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">index</span> <span class="o">-</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;?&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">sample</span> <span class="k">if</span> <span class="n">index</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Review </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="s1">&#39;Positive&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">prediction</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0.5</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;Negative&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">decoded_review</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/imdb_word_index.json
1641221/1641221 [==============================] - 0s 0us/step
1/1 [==============================] - 0s 182ms/step
Review 1: Negative
please give this one a miss br br and the rest of the cast rendered terrible performances the show is flat flat flat br br i don&#39;t know how michael madison could have allowed this one on his plate he almost seemed to know this wasn&#39;t going to work out and his performance was quite so all you madison fans give this a miss 

Review 2: Positive
this film requires a lot of patience because it focuses on mood and character development the plot is very simple and many of the scenes take place on the same set in frances the sandy dennis character apartment but the film builds to a disturbing climax br br the characters create an atmosphere with sexual tension and psychological it&#39;s very interesting that robert altman directed this considering the style and structure of his other films still the trademark altman audio style is evident here and there i think what really makes this film work is the brilliant performance by sandy dennis it&#39;s definitely one of her darker characters but she plays it so perfectly and convincingly that it&#39;s scary michael burns does a good job as the mute young man regular altman player michael murphy has a small part the moody set fits the content of the story very well in short this movie is a powerful study of loneliness sexual and desperation be patient up the atmosphere and pay attention to the wonderfully written script br br i praise robert altman this is one of his many films that deals with unconventional fascinating subject matter this film is disturbing but it&#39;s sincere and it&#39;s sure to a strong emotional response from the viewer if you want to see an unusual film some might even say bizarre this is worth the time br br unfortunately it&#39;s very difficult to find in video stores you may have to buy it off the internet 

Review 3: Positive
at a time when motion picture animation of all sorts was in its br br the political of the russian revolution caused to move to paris where one of his first productions was a dark political satire known as or the who wanted a king a strain of black comedy can be found in almost all of films but here it is very dark indeed aimed more at grown ups who can appreciate the satirical aspects than children who would most likely find the climax i&#39;m middle aged and found it pretty myself and indeed of the film intended for english speaking viewers of the 1920s were given title cards filled with and in order to help the sharp of the finale br br our tale is set in a swamp the where the citizens are unhappy with their government and have called a special session to see what they can do to improve matters they decide to for a king the crowds are animated in this opening sequence it couldn&#39;t have been easy to make so many frog puppets look alive simultaneously while for his part is depicted as a white guy in the clouds who looks like he&#39;d rather be taking a when sends them a tree like god who regards them the decide that this is no improvement and demand a different king irritated sends them a br br delighted with this looking new king who towers above them the welcome him with a of dressed the mayor steps forward to hand him the key to the as cameras record the event to everyone&#39;s horror the promptly eats the mayor and then goes on a merry rampage citizens at random a title card reads news of the king&#39;s throughout the kingdom when the now terrified once more for help he loses his temper and their community with lightning the moral of our story delivered by a hapless frog just before he is eaten is let well enough alone br br considering the time period when this startling little film was made and considering the fact that it was made by a russian at the height of that country&#39;s civil war it would be easy to see this as a about those events may or may not have had turmoil in mind when he made but whatever his choice of material the film stands as a tale of universal could be the soviet union italy germany or japan in the 1930s or any country of any era that lets its guard down and is overwhelmed by it&#39;s a fascinating film even a charming one in its macabre way but its message is no joke 

Review 4: Positive
i generally love this type of movie however this time i found myself wanting to kick the screen since i can&#39;t do that i will just complain about it this was absolutely idiotic the things that happen with the dead kids are very cool but the alive people are absolute idiots i am a grown man pretty big and i can defend myself well however i would not do half the stuff the little girl does in this movie also the mother in this movie is reckless with her children to the point of neglect i wish i wasn&#39;t so angry about her and her actions because i would have otherwise enjoyed the flick what a number she was take my advise and fast forward through everything you see her do until the end also is anyone else getting sick of watching movies that are filmed so dark anymore one can hardly see what is being filmed as an audience we are involved with the actions on the screen so then why the hell can&#39;t we have night vision 

Review 5: Positive
like some other people wrote i&#39;m a die hard mario fan and i loved this game br br this game starts slightly boring but trust me it&#39;s worth it as soon as you start your hooked the levels are fun and they will hook you your mind turns to i&#39;m not kidding this game is also and is beautifully done br br to keep this spoiler free i have to keep my mouth shut about details but please try this game it&#39;ll be worth it br br story 9 9 action 10 1 it&#39;s that good 10 attention 10 average 10 

Review 6: Positive
i&#39;m absolutely disgusted this movie isn&#39;t being sold all who love this movie should email disney and increase the demand for it they&#39;d eventually have to sell it then i&#39;d buy copies for everybody i know everything and everybody in this movie did a good job and i haven&#39;t figured out why disney hasn&#39;t put this movie on dvd or on vhs in rental stores at least i haven&#39;t seen any copies this is a wicked good movie and should be seen by all the kids in the new generation don&#39;t get to see it and i think they should it should at least be put back on the channel this movie doesn&#39;t deserve a cheap it deserves the real thing i&#39;m them now this movie will be on dvd 

Review 7: Positive
later used by frank in mr deeds goes to town and meet john but in no one individual is cast as a hero or heroine the story is told through a series of scenes that are combined in a special effect known as montage the editing and selection of short segments to produce a desired effect on the viewer d w griffith also used the montage but no one it so well as br br the artistic filming of the crew sleeping in their is by the swinging of tables suspended from chains in the in contrast the confrontation between the crew and their officers is charged with electricity and the of the masses demonstrate their rage with injustice br br introduced the technique of showing an action and repeating it again but from a slightly different angle to demonstrate intensity the breaking of a plate bearing the words give us this day our daily bread the beginning of the end this technique is used in last year at also when the surgeon is tossed over the side his from the it was these glasses that the officer used to and pass the meat this sequence ties the punishment to the corruption of the era br br the most noted sequence in the film and perhaps in all of film history is the steps the broad of the steps are filled with hundreds of extras rapid and dramatic violence is always suggested and not explicit yet the visual images of the deaths of a few will last in the minds of the viewer forever br br the shots of boots and legs the steps are cleverly with long menacing shadows from a sun at the top of the steps the pace of the sequence is deliberately varied between the soldiers and a few civilians who up courage to beg them to stop a close up of a woman&#39;s face frozen in horror after being struck by a sword is the direct of the bank in bonnie in clyde and gives a lasting impression of the horror of the regime br br the death of a young mother leads to a baby down the steps in a sequence that has been copied by hitchcock in foreign by terry gilliam in brazil and brian in the this sequence is shown repeatedly from various angles thus drawing out what probably was only a five second event br br is a film that the revolutionary spirit it for those already committed and it for the it of fire and with the senseless of the regime its greatest impact has been on film students who have borrowed and only slightly improved on techniques invented in russia several generations ago 

Review 8: Negative
the richard dog is to joan fontaine dog however when bing crosby arrives in town to sell a record player to the emperor his dog is attacked by dog after a revenge attack where is from town a insists that dog must confront dog so that she can overcome her fears this is arranged and the dogs fall in love so do and the rest of the film passes by with romance and at the end dog gives birth but who is the father br br the dog story is the very weak vehicle that is used to try and create a story between humans its a terrible storyline there are 3 main musical pieces all of which are rubbish bad songs and dreadful choreography its just an extremely boring film bing has too many words in each sentence and delivers them in an almost irritating manner its not funny ever but its meant to be bing and joan have done much better than this 

Review 9: Positive
hollywood had a long love affair with bogus nights tales but few of these products have stood the test of time the most memorable were the jon hall maria films which have long since become camp this one is filled with dubbed songs and slapstick it&#39;s a truly crop of corn and pretty near today it was nominated for its imaginative special effects which are almost in this day and age mainly of trick photography the only outstanding positive feature which survives is its beautiful color and clarity sad to say of the many films made in this genre few of them come up to alexander original thief of almost any other nights film is superior to this one though it&#39;s a loser 

Review 10: Positive
this film is where the batman franchise ought to have stopped though i will that the ideas behind batman forever were excellent and could have been easily realised by a competent director as it turned out this was not to be the case br br apparently warner brothers executives were disappointed with how dark this second batman film from tim burton turned out apart from the idiocy of expecting anything else from burton and the conservative of their subsequent decision to turn the franchise into an homage to the sixties tv series i fail to understand how batman returns can be considered at all disappointing br br true it is not quite the equal of the first film though it all the minor of style found in batman a weaker script that the between not just two but three characters invites comparisons to the masterful pairing of keaton and jack nicholson as the joker in the first film yet for all this it remains a dark film true to the way the batman was always meant to be and highly satisfying br br michael keaton returns as the batman and his alter ego bruce wayne with max christopher walken named in honour of the 1920s german silent actor his partner in crime the penguin danny in brilliant makeup reminiscent of laurence richard iii and kyle the michelle pfeiffer whom wayne romances both as himself and as the batman the four principals turn in excellent performances especially walken and while together keaton and pfeiffer explore the darker side of double identities br br there are some intriguing concepts in this film about the only weakness i can really point out is a certain to the script in some places which i think is due mostly to the way this film is a four fight there simply isn&#39;t enough time to properly explore what&#39;s going on br br nevertheless this is a damn good film i highly recommend watching this in with the first and then for how good the series could have been had it continued under burton and keaton 
</pre></div>
</div>
</div>
</div>
<p>以上がRNNの作り方の一例です。</p>
<p>「epochs=10」は全データを10回繰り返し学習することを意味し、「batch_size=128」は128個のデータごとに学習を進めることを意味します。また、「validation_split=0.2」は、全データのうち20%を検証データ（モデルが学習に使わないで途中結果のチェックに使うデータ）として使うことを意味します。</p>
<p>このコードを実行すると、人工知能はレビューを読み、肯定的か否定的かを学習し、その結果を「history」という名前の変数に保存します。これにより、学習がうまく進んだかどうかを後から確認することが可能になります。</p>
<p>以上が、再帰型ニューラルネットワーク（RNN）の説明と基本的な実装例です。特に時系列データを扱う際には非常に役立つツールですので、ぜひ理解しておくと良いでしょう。</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="1_%E6%A9%9F%E6%A2%B0%E5%AD%A6%E7%BF%92%E3%81%AE%E5%9F%BA%E7%A4%8E.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">レッスン1：機械学習の基礎</p>
        </div>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Hafumi Nishi<br/>
    
        &copy; Copyright 2023.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>